// RUN: choreo -es -t cute -arch=sm_86 %s -o - | FileCheck %s --check-prefix=CHECK-86
// RUN: choreo -es -t cute -arch=sm_90a %s -o - | FileCheck %s --check-prefix=CHECK-90a

#include "choreo.h"


__co__ void foo() {
  parallel {m, n} by [1, 1] : block {
    shared f32 [1] smem0;
    shared f32 [1] smem1;
    dma.copy smem0 => smem1;
  }
}

// CHECK-86:  __shared__ alignas(16) unsigned char anon_1[32];
// CHECK-86:  float* smem0 = (float*)(anon_1 + 16);
// CHECK-86:  float* smem1 = (float*)(anon_1 + 0);

// CHECK-90a:  __shared__ alignas(128) unsigned char anon_1[256];
// CHECK-90a:  float* smem0 = (float*)(anon_1 + 128);
// CHECK-90a:  float* smem1 = (float*)(anon_1 + 0);
