// RUN: choreo -i %s | FileCheck --match-full-lines %s

// device program
__co__ void bounded_vars(s32 [20, 7] a, s32 mdspan<1> b) {
  parallel p by 6 {
    with index = {x, y} in [10, 20], z in [7] {
      foreach x { }
    }
  }
}

// CHECK: Parameter: ::bounded_vars::a, Type: s32 mdspan<2> [20, 7]
// CHECK: Parameter: ::bounded_vars::b, Type: s32 mdspan<1> [::bounded_vars::$0]
// CHECK: Bounded: ::bounded_vars{{(::paraby_[0-9]+)*}}::p, Type: {int}->[6]
// CHECK: Bounded: ::bounded_vars{{(::paraby_[0-9]+)*}}::within_0::index, Type: {int,int}->[10, 20]
// CHECK: Bounded: ::bounded_vars{{(::paraby_[0-9]+)*}}::within_0::x, Type: {int}->[10]
// CHECK: Bounded: ::bounded_vars{{(::paraby_[0-9]+)*}}::within_0::y, Type: {int}->[20]
// CHECK: Bounded: ::bounded_vars{{(::paraby_[0-9]+)*}}::within_0::z, Type: {int}->[7]
