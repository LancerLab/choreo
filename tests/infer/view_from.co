// RUN: choreo -ii %s | FileCheck %s

__co__ void foo(f32 [64, 32] a) {
  parallel p by 2 {
    b = a.view(16, 8: 12, 3).from(17, 18);
    dma.copy a.view(16, 4).from(14, 13) => shared;
    dma.copy a.view(17, 3 : 7, 2).from(11, 10) => shared;
    dma.copy b.chunkat(p, p) => shared;
  }
}

// CHECK: Parameter: ::foo::a, Type: f32 mdspan<2> [64, 32] {32, 1}
// CHECK: Symbol:    ::foo{{(::paraby_[0-9]+)*}}::b, Type: global f32 mdspan<2> [16, 8] {12, 3}
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>shared f32 mdspan<2> [16, 4] {4, 1}
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>shared f32 mdspan<2> [17, 3] {3, 1}
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>shared f32 mdspan<2> [8, 4] {4, 1}
// CHECK: Function:  ::foo, Type: void (*)(f32 mdspan<2> [64, 32] {32, 1})
