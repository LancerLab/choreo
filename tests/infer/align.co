// RUN: choreo -vn %s | FileCheck %s

__co__ void foo(f32 [128, 512] a) {
  parallel p by 3, q by 6 {
    assert(__alignup(a.span(0), #q) ==  132, "alignup(128, 6) == 132");
    assert(__aligndown(a.span(0)/#p, 32) == 32, "aligndown(128/3, 32) == 32");
   }
}

// CHECK:   scope-1 {
// CHECK:    New VN #[[vn0:[0-9]+]]: 'const_1'
// CHECK:    Alias "::@__choreo_no_tiling__" -> #[[vn0]]
// CHECK:    New VN #[[vn1:[0-9]+]]: '::__choreo_no_tiling__'
// CHECK:    New VN #[[vn2:[0-9]+]]: 'const_128'
// CHECK:    New VN #[[vn3:[0-9]+]]: 'const_512'
// CHECK:    New VN #[[vn4:[0-9]+]]: '#[[vn2]],#[[vn3]]'
// CHECK:    Alias "::foo::a.span" -> #[[vn4]]
// CHECK:    scope-2 {
// CHECK:     New VN #[[vn5:[0-9]+]]: 'const_3'
// CHECK:     Alias "::foo{{(::paraby_[0-9]+)*}}::@p" -> #[[vn5]]
// CHECK:     New VN #[[vn6:[0-9]+]]: '::foo{{(::paraby_[0-9]+)*}}::p'
// CHECK:     Alias "::foo{{(::paraby_[0-9]+)*}}::@p__elem__x" -> #[[vn5]]
// CHECK:     New VN #[[vn7:[0-9]+]]: '::foo{{(::paraby_[0-9]+)*}}::p__elem__x'
// CHECK:     scope-3 {
// CHECK:      New VN #[[vn8:[0-9]+]]: 'const_6'
// CHECK:      Alias "::foo{{(::paraby_[0-9]+)*}}::@q" -> #[[vn8]]
// CHECK:      New VN #[[vn9:[0-9]+]]: '::foo{{(::paraby_[0-9]+)*}}::q'
// CHECK:      Alias "::foo{{(::paraby_[0-9]+)*}}::@q__elem__x" -> #[[vn8]]
// CHECK:      New VN #[[vn10:[0-9]+]]: '::foo{{(::paraby_[0-9]+)*}}::q__elem__x'
// CHECK:      New VN #[[vn11:[0-9]+]]: 'const_0'
// CHECK:      New VN #[[vn12:[0-9]+]]: 'const_134'
// CHECK:      New VN #[[vn13:[0-9]+]]: 'const_133'
// CHECK:      New VN #[[vn14:[0-9]+]]: 'const_22'
// CHECK:      New VN #[[vn15:[0-9]+]]: 'const_132'
// CHECK:      New VN #[[vn16:[0-9]+]]: 'true'
// CHECK:      New VN #[[vn17:[0-9]+]]: 'const_42'
// CHECK:      New VN #[[vn18:[0-9]+]]: 'const_32'
// CHECK:     } // end scope-3
// CHECK:    } // end scope-2
// CHECK:   } // end scope-1
