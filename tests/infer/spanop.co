// RUN: choreo -dv=valno -i %s 2>&1 | FileCheck %s
__co__ void foo(f32 [32, 16, 8] a) {
  b = {6, 8};
  parallel p by 4, q = {q0, q1} by [2, 2] {
    dma.copy a.subspan(7, b) => local;
    dma.copy a.modspan(7, b) => local;
    dma.copy a.view([b, 3]).from(1, 0, p) => local;
    dma.copy a.chunkat(p, q).subspan(b, 3).modspan(3, 3, 3) => local;
  }
}

// CHECK: values of subspan offset: [0, 0, 0]
// CHECK: values of modspan offset: [4, 2, 1]
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>local f32 mdspan<3> [7, 6, 8]
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>local f32 mdspan<3> [4, 4, 1]
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>local f32 mdspan<3> [6, 8, 3]
// CHECK: Future:    ::foo{{(::paraby_[0-9]+)*}}::(anon), Type: sync=>local f32 mdspan<3> [1, 2, 1]
