// RUN: choreo -i %s | FileCheck --match-full-lines %s
// RUN: choreo -vn %s | FileCheck --check-prefix=VALNO --match-full-lines %s

// device program
__co__ void foo(f32 [2, 3, 4] d, int e) {
  a = { 5, 1, d.span(2) / 3 };
  b = {e, 3};
}

// VALNO:  scope-1 {
// VALNO:   New VN #0: 'const_1'
// VALNO:   Alias "::@__choreo_no_tiling__" -> #0
// VALNO:   New VN #1: '::__choreo_no_tiling__'
// VALNO:   New VN #2: 'const_2'
// VALNO:   New VN #3: 'const_3'
// VALNO:   New VN #4: 'const_4'
// VALNO:   New VN #5: '#2,#3,#4'
// VALNO:   Alias "::foo::d.span" -> #5
// VALNO:   New VN #6: '::foo::e'
// VALNO:   New VN #7: 'const_5'
// VALNO:   New VN #8: '#7,#0,#0'
// VALNO:   Alias "::foo::a" -> #8
// VALNO:   New VN #9: '#6,#3'
// VALNO:   Alias "::foo::b" -> #9
// VALNO:  } // end scope-1

// CHECK: Parameter: ::foo::d, Type: f32 mdspan<3> [2, 3, 4]
// CHECK: Parameter: ::foo::e, Type: s32
// CHECK: Symbol:    ::foo::a, Type: ituple<3>
// CHECK: Symbol:    ::foo::b, Type: ituple<2>
