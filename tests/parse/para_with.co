// RUN: choreo -e %s | FileCheck %s

__co__ int para_with(int b) {
  ndims : [3, b];
  int sum = 0;
  parallel p by 6 {   // bounded to range [0, 6)
    with index in ndims { // bounded to ranges {[0, 3), [0, b) }
      sum = sum + index(0);
    }
  }
}

// CHECK: ChoreoFunction
// CHECK:  `- Name: para_with
// CHECK:  `- Return type: s32
// CHECK:  `- Parameters:
// CHECK:    `-  type: s32, symbol: b
// CHECK:  `- Type Decl: ndims - [ 3 b ]
// CHECK:  `- Var Decl (s32): sum = 0
// CHECK:  `- Parallelization:  index symbol: p, bound [0, 6)
// CHECK:   `- With Block:
// CHECK:     (within constraints)
// CHECK:     `- index in ndims
// CHECK:     (with statements)
// CHECK:     `- Assign: sum =  (sum + index(0))
