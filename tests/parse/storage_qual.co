// RUN: choreo -e %s | FileCheck --match-full-lines %s
#include <iostream>

// device program
__co__ s16 mdspan<4> spans(f32 mdspan<3> d, int f) {
  dim1 : [100, 100];  // shape, mdspan node
  mdspan dim2 : [9, f];
  local f16 [dim1] a;
  shared bf16 [dim2] b;
  global s8 [d.span] c;
}

// CHECK: ChoreoFunction
// CHECK:  `- Name: spans
// CHECK:  `- Return type: s16 <4>
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 <3>, symbol: d
// CHECK:    `-  type: s32, symbol: f
// CHECK:  `- Type Decl: dim1 - [ 100 100 ]
// CHECK:  `- Type Decl: dim2 - [ 9 f ]
// CHECK:  `- Var Decl (f16 [ dim1 ], local): a
// CHECK:  `- Var Decl (bf16 [ dim2 ], shared): b
// CHECK:  `- Var Decl (s8 [ d.span ], global): c
