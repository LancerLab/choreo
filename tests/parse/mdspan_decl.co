// RUN: choreo -e %s | FileCheck --match-full-lines %s
#include <iostream>

// choreo program
__co__ f16 mdspan<2> spans(f32 mdspan<3> d, int f) {
  dim1 : [100, 100];  // shape, mdspan node
  mdspan dim2 : [9, f];
  ndims : d.span[(2), (1), (0)];
  mdspan<4> dim3 : [9, 102, dim1(1), d.span(2)];
}

// CHECK: ChoreoFunction
// CHECK:  `- Name: spans
// CHECK:  `- Return type: f16 <2>
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 <3>, symbol: d
// CHECK:    `-  type: s32, symbol: f
// CHECK:  `- Type Decl: dim1 - [ 100 100 ]
// CHECK:  `- Type Decl: dim2 - [ 9 f ]
// CHECK:  `- Type Decl: ndims - [ d(2) d(1) d(0) ]
// CHECK:  `- Type Decl: dim3 - [ 9 102 dim1(1) d.span(2) ]

// host program
int bar(int a) {
  return foo(a);
}
