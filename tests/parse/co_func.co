// RUN: choreo -e %s | FileCheck --match-full-lines %s

// recognize the __co__ function

#include <iostream>

// device program
__co__ int foo(f32 mdspan<1> a, int) { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: foo
// CHECK:  `- Return type: s32
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 <1>, symbol: a
// CHECK:    `-  type: s32, symbol: anon_0

__co__ f16 [1, 2] bar(f32 [3, 4, 5] b) { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: bar
// CHECK:  `- Return type: f16 [ 1 2 ]
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 [ 3 4 5 ], symbol: b

__co__ bf16 mdspan<2> foobar(f32 [?, 4, 5] c, bool d) { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: foobar
// CHECK:  `- Return type: bf16 <2>
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 [ ? 4 5 ], symbol: c
// CHECK:    `-  type: bool, symbol: d

__co__ void foobar(f32 [?, 4, 5] e, bf16 [?, ?, 1] f) { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: foobar
// CHECK:  `- Return type: void
// CHECK:  `- Parameters:
// CHECK:    `-  type: f32 [ ? 4 5 ], symbol: e
// CHECK:    `-  type: bf16 [ ? ? 1 ], symbol: f

__co__ auto barfoo(f32 [?, 4, 5] a) { return a; }

// CHECK:ChoreoFunction
// CHECK: `- Name: barfoo
// CHECK: `- Return type: unknown
// CHECK: `- Parameters:
// CHECK:   `-  type: f32 [ ? 4 5 ], symbol: a
// CHECK: `- Return: a

__co__ auto none() { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: none
// CHECK:  `- Return type: unknown
// CHECK:  `- Parameters:

__co__ auto matmul(f32 [M, N] a, f32 [N, K] b) { }

// CHECK: ChoreoFunction
// CHECK:  `- Name: matmul
// CHECK:  `- Return type: unknown
// CHECK:  `- Parameters:
// CHECK:   `-  type: f32 [ M N  ], symbol: a
// CHECK:   `-  type: f32 [ N K  ], symbol: b
