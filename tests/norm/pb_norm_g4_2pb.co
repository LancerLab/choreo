// RUN: choreo -t cute -arch=sm_90a -pa=pbfill -sa=pbfill %s | FileCheck %s

__co__ void bar0() { parallel by 2 parallel by 4;  }
__co__ void bar1() { parallel x by 3 parallel y by 5;  }
__co__ void bar2() { parallel z by 4 : block parallel t by 6;  }
__co__ void bar3() { parallel r by 5 parallel s by 7 : thread;  }
__co__ void bar4() { parallel r by 6 : group parallel s by 8;  }
__co__ void bar5() { parallel r by 7 parallel s by 9: group;  }
__co__ void bar6() { parallel r by 8 : group-4 parallel s by 10;  }
__co__ void bar7() { parallel r by 9 parallel s by 11 : group-4;  }
__co__ void bar8() { parallel r by 10 : block parallel s by 12 : group-4;  }
__co__ void bar9() { parallel r by 11 : group-4 parallel s by 13 : group;  }
__co__ void bar11() { parallel r by 12 : group parallel s by 14 : thread;  }
__co__ void bar12() { parallel r by 13 : block parallel s by 15 : group;  }
__co__ void bar13() { parallel r by 14 : group-4 parallel s by 16 : thread;  }
__co__ void bar14() { parallel r by 15 : block parallel s by 17 : thread;  }

// CHECK:  `- Name: bar0
// CHECK:  `- block Parallelization(o): index symbol: anon_0, bound [0, 2)
// CHECK:                      index component: {anon_0__elem__x}, corresponding ubound: [2]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_1, bound [0, 1)
// CHECK:                       index component: {anon_pb_1__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_0, bound [0, 1)
// CHECK:                        index component: {anon_pb_0__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_1, bound [0, 4)
// CHECK:                         index component: {anon_1__elem__x}, corresponding ubound: [4]

// CHECK:  `- Name: bar1
// CHECK:  `- block Parallelization(o): index symbol: x, bound [0, 3)
// CHECK:                      index component: {x__elem__x}, corresponding ubound: [3]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_3, bound [0, 1)
// CHECK:                       index component: {anon_pb_3__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_2, bound [0, 1)
// CHECK:                        index component: {anon_pb_2__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: y, bound [0, 5)
// CHECK:                         index component: {y__elem__x}, corresponding ubound: [5]

// CHECK:  `- Name: bar2
// CHECK:  `- block Parallelization(o): index symbol: z, bound [0, 4)
// CHECK:                      index component: {z__elem__x}, corresponding ubound: [4]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_5, bound [0, 1)
// CHECK:                       index component: {anon_pb_5__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_4, bound [0, 1)
// CHECK:                        index component: {anon_pb_4__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: t, bound [0, 6)
// CHECK:                         index component: {t__elem__x}, corresponding ubound: [6]

// CHECK:  `- Name: bar3
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 5)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [5]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_7, bound [0, 1)
// CHECK:                       index component: {anon_pb_7__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_6, bound [0, 1)
// CHECK:                        index component: {anon_pb_6__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 7)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [7]

// CHECK:  `- Name: bar4
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_9, bound [0, 1)
// CHECK:                      index component: {anon_pb_9__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_8, bound [0, 1)
// CHECK:                       index component: {anon_pb_8__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: r, bound [0, 6)
// CHECK:                        index component: {r__elem__x}, corresponding ubound: [6]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 8)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [8]

// CHECK:  `- Name: bar5
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 7)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [7]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_11, bound [0, 1)
// CHECK:                       index component: {anon_pb_11__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: s, bound [0, 9)
// CHECK:                        index component: {s__elem__x}, corresponding ubound: [9]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_10, bound [0, 32)
// CHECK:                         index component: {anon_pb_10__elem__x}, corresponding ubound: [32]

// CHECK:  `- Name: bar6
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_13, bound [0, 1)
// CHECK:                      index component: {anon_pb_13__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: r, bound [0, 8)
// CHECK:                       index component: {r__elem__x}, corresponding ubound: [8]
// CHECK:    `- group Parallelization: index symbol: anon_pb_12, bound [0, 1)
// CHECK:                        index component: {anon_pb_12__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 10)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [10]

// CHECK:  `- Name: bar7
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 9)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [9]
// CHECK:   `- group-4 Parallelization: index symbol: s, bound [0, 11)
// CHECK:                       index component: {s__elem__x}, corresponding ubound: [11]
// CHECK:    `- group Parallelization: index symbol: anon_pb_15, bound [0, 1)
// CHECK:                        index component: {anon_pb_15__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_14, bound [0, 128)
// CHECK:                         index component: {anon_pb_14__elem__x}, corresponding ubound: [128]

// CHECK:  `- Name: bar8
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 10)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [10]
// CHECK:   `- group-4 Parallelization: index symbol: s, bound [0, 12)
// CHECK:                       index component: {s__elem__x}, corresponding ubound: [12]
// CHECK:    `- group Parallelization: index symbol: anon_pb_17, bound [0, 1)
// CHECK:                        index component: {anon_pb_17__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_16, bound [0, 128)
// CHECK:                         index component: {anon_pb_16__elem__x}, corresponding ubound: [128]

// CHECK:  `- Name: bar9
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_19, bound [0, 1)
// CHECK:                      index component: {anon_pb_19__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: r, bound [0, 11)
// CHECK:                       index component: {r__elem__x}, corresponding ubound: [11]
// CHECK:    `- group Parallelization: index symbol: s, bound [0, 13)
// CHECK:                        index component: {s__elem__x}, corresponding ubound: [13]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_18, bound [0, 32)
// CHECK:                         index component: {anon_pb_18__elem__x}, corresponding ubound: [32]

// CHECK:  `- Name: bar11
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_21, bound [0, 1)
// CHECK:                      index component: {anon_pb_21__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_20, bound [0, 1)
// CHECK:                       index component: {anon_pb_20__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: r, bound [0, 12)
// CHECK:                        index component: {r__elem__x}, corresponding ubound: [12]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 14)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [14]

// CHECK:  `- Name: bar12
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 13)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [13]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_23, bound [0, 1)
// CHECK:                       index component: {anon_pb_23__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: s, bound [0, 15)
// CHECK:                        index component: {s__elem__x}, corresponding ubound: [15]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_22, bound [0, 32)
// CHECK:                         index component: {anon_pb_22__elem__x}, corresponding ubound: [32]

// CHECK:  `- Name: bar13
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_25, bound [0, 1)
// CHECK:                      index component: {anon_pb_25__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: r, bound [0, 14)
// CHECK:                       index component: {r__elem__x}, corresponding ubound: [14]
// CHECK:    `- group Parallelization: index symbol: anon_pb_24, bound [0, 1)
// CHECK:                        index component: {anon_pb_24__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 16)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [16]

// CHECK:  `- Name: bar14
// CHECK:  `- block Parallelization(o): index symbol: r, bound [0, 15)
// CHECK:                      index component: {r__elem__x}, corresponding ubound: [15]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_27, bound [0, 1)
// CHECK:                       index component: {anon_pb_27__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_26, bound [0, 1)
// CHECK:                        index component: {anon_pb_26__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: s, bound [0, 17)
// CHECK:                         index component: {s__elem__x}, corresponding ubound: [17]
