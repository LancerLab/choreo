// RUN: choreo -t cute -arch=sm_90a -pa=pbfill -sa=pbfill %s | FileCheck %s

__co__ void foo0() { parallel by 2;  }
__co__ void foo1() { parallel x by 3;  }
__co__ void foo2() { parallel y by 4 : thread;  }
__co__ void foo3() { parallel z by 5 : group;  }
__co__ void foo4() { parallel s by 6 : group-4;  }
__co__ void foo5() { parallel t by 7 : block;  }

// CHECK:  `- Name: foo0
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_2, bound [0, 1)
// CHECK:                      index component: {anon_pb_2__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_1, bound [0, 1)
// CHECK:                       index component: {anon_pb_1__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_0, bound [0, 1)
// CHECK:                        index component: {anon_pb_0__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_0, bound [0, 2)
// CHECK:                         index component: {anon_0__elem__x}, corresponding ubound: [2]

// CHECK:  `- Name: foo1
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_5, bound [0, 1)
// CHECK:                      index component: {anon_pb_5__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_4, bound [0, 1)
// CHECK:                       index component: {anon_pb_4__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_3, bound [0, 1)
// CHECK:                        index component: {anon_pb_3__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: x, bound [0, 3)
// CHECK:                         index component: {x__elem__x}, corresponding ubound: [3]

// CHECK:  `- Name: foo2
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_8, bound [0, 1)
// CHECK:                      index component: {anon_pb_8__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_7, bound [0, 1)
// CHECK:                       index component: {anon_pb_7__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_6, bound [0, 1)
// CHECK:                        index component: {anon_pb_6__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: y, bound [0, 4)
// CHECK:                         index component: {y__elem__x}, corresponding ubound: [4]

// CHECK:  `- Name: foo3
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_11, bound [0, 1)
// CHECK:                      index component: {anon_pb_11__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_10, bound [0, 1)
// CHECK:                       index component: {anon_pb_10__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: z, bound [0, 5)
// CHECK:                        index component: {z__elem__x}, corresponding ubound: [5]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_9, bound [0, 32)
// CHECK:                         index component: {anon_pb_9__elem__x}, corresponding ubound: [32]

// CHECK:  `- Name: foo4
// CHECK:  `- block Parallelization(o): index symbol: anon_pb_14, bound [0, 1)
// CHECK:                      index component: {anon_pb_14__elem__x}, corresponding ubound: [1]
// CHECK:   `- group-4 Parallelization: index symbol: s, bound [0, 6)
// CHECK:                       index component: {s__elem__x}, corresponding ubound: [6]
// CHECK:    `- group Parallelization: index symbol: anon_pb_13, bound [0, 1)
// CHECK:                        index component: {anon_pb_13__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_12, bound [0, 128)
// CHECK:                         index component: {anon_pb_12__elem__x}, corresponding ubound: [128]

// CHECK:  `- Name: foo5
// CHECK:  `- block Parallelization(o): index symbol: t, bound [0, 7)
// CHECK:                      index component: {t__elem__x}, corresponding ubound: [7]
// CHECK:   `- group-4 Parallelization: index symbol: anon_pb_17, bound [0, 1)
// CHECK:                       index component: {anon_pb_17__elem__x}, corresponding ubound: [1]
// CHECK:    `- group Parallelization: index symbol: anon_pb_16, bound [0, 1)
// CHECK:                        index component: {anon_pb_16__elem__x}, corresponding ubound: [1]
// CHECK:     `- thread Parallelization: index symbol: anon_pb_15, bound [0, 1)
// CHECK:                         index component: {anon_pb_15__elem__x}, corresponding ubound: [1]
