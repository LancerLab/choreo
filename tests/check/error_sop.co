// RUN: not choreo %s -sa=check 2>&1 | FileCheck %s

__co__ auto foo(s32[2, 16, 128] input2) {
  
  global s32 [32, 128] t{55};
  parallel p by 2, q by 4
    foreach i in [16] {
      dma.copy input2.chunkat(p, q, i).span_as(4, 8) =>
        t.chunkat(p#q, i);
      dma.copy input2.chunkat(p, q, _).span_as(1, 4*128) => local;
      foreach j in [4]
        dma.copy input2.chunkat(_, p, q).chunkat(_, j, i) => local;
    }

  return t;
}

// CHECK: warning: 'span_as' is applied to non-contiguous spanned data ([1, 4, 8] {2048, 128, 1}).
// CHECK: warning: 'span_as' is applied to non-contiguous spanned data ([1, 4, 128] {2048, 128, 1}).
