// RUN: choreo -es %s -o /dev/null 2>&1 | FileCheck %s --check-prefix=CHECK

__co__ auto placeholder(f32 [24, 17, 128] a) {
  global event g[3];

  parallel p by 3, q by 4 {
    trigger g;
    wait g;
    shared event e[4];
    trigger e;
    wait e;

    shared event y[3];
    inthreads.async (p < 1) {
      trigger y[p];
    }

    inthreads.async (p == 1) {
      wait y[0];
    }

    shared event x[3];
    inthreads(q <= 2) {
      trigger x;
      wait x;
    }
  }

  return 1;
}

// CHECK: warning: Be careful to trigger event outside inthreads block, which may lead to parallelism issues.
// CHECK:       trigger g;
// CHECK: warning: Be careful to wait event outside inthreads block, which may lead to parallelism issues.
// CHECK:       wait g;
// CHECK: warning: Be careful to trigger event outside inthreads block, which may lead to parallelism issues.
// CHECK:       trigger e;
// CHECK: warning: Be careful to wait event outside inthreads block, which may lead to parallelism issues.
// CHECK:       wait e;

// CHECK-NOT: warning: Be careful to trigger event outside inthreads block, which may lead to parallelism issues.
